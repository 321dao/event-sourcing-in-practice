<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=1024, user-scalable=no">

	
  <title>Event sourcing in practice</title>
   <meta name="description" content="Learn about Event Sourcing and Command Sourcing as a persistance mechanism for Domain-Driven Design">
  <meta name="author" content="Johannes Seitz">


  <!-- Required stylesheet -->
  <link rel="stylesheet" href="./static/core/deck.core.css">
  <link rel="stylesheet" href="./static/custom.css">

  <!-- Extension CSS files go here. Remove or add as needed. -->
  <link rel="stylesheet" media="screen" href="./static/960.css">
  <link rel="stylesheet" media="screen" href="./static/pygments-colorful.css">
  <link rel="stylesheet" media="screen" href="./static/extensions/goto/deck.goto.css">
  <link rel="stylesheet" media="screen" href="./static/extensions/menu/deck.menu.css">
  <link rel="stylesheet" media="screen" href="./static/extensions/navigation/deck.navigation.css">
  <link rel="stylesheet" media="screen" href="./static/extensions/status/deck.status.css">
  <link rel="stylesheet" media="screen" href="./static/extensions/hash/deck.hash.css">
  <link rel="stylesheet" media="screen" href="./static/extensions/scale/deck.scale.css">

  <!-- Style theme. More available in /themes/style/ or create your own. -->
  <link rel="stylesheet" media="screen" href="./static/themes/style/swiss.css">

  <!-- Transition theme. More available in /themes/transition/ or create your own. -->
  <link rel="stylesheet" media="screen" href="./static/themes/transition/horizontal-slide.css">

  <!-- Basic black and white print styles -->
  <link rel="stylesheet" media="print" href="./static/core/print.css">

  <!-- Required Modernizr file -->
  <script src="./static/modernizr.custom.js"></script>
</head>
<body>
  <div class="deck-container">

    <!-- Begin slides. Just make elements with a class of slide. -->

	
	
	    <!-- {&#39;markdown_content&#39;: u&#39;&lt;h1&gt;Event Sourcing &lt;br/&gt; in practice&lt;/h1&gt;\n&lt;header&gt;&lt;a href=&quot;https://github.com/Ookami86/event-sourcing-in-practice&quot;&gt;&lt;img style=&quot;position: absolute; top: 0; right: 0; border: 0;&quot; src=&quot;https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png&quot; alt=&quot;Fork me on GitHub&quot;&gt;&lt;/a&gt;&lt;/header&gt;\n\n&lt;footer style=&quot;position:absolute;right:0px;bottom:20px&quot;&gt;\n    &lt;a rel=&quot;license&quot; href=&quot;http://creativecommons.org/licenses/by/4.0/&quot;&gt;&lt;img alt=&quot;Creative Commons License&quot; style=&quot;border-width:0&quot; src=&quot;static/img/cc.png&quot; /&gt;&lt;/a&gt;\n&lt;/footer&gt;&#39;, &#39;path&#39;: &#39;slides/00-title.md&#39;, &#39;title&#39;: &#39;title.md&#39;} -->
	    <section class="slide"  id="title.md" >
			
				
					<h1>Event Sourcing <br/> in practice</h1>
<header><a href="https://github.com/Ookami86/event-sourcing-in-practice"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"></a></header>

<footer style="position:absolute;right:0px;bottom:20px">
    <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="static/img/cc.png" /></a>
</footer>
				
	  		
	    </section>
	
	    <!-- {&#39;markdown_content&#39;: u&#39;&lt;h2&gt;Who we are&lt;/h2&gt;\n&lt;p&gt;&lt;img alt=&quot;Picture of the Vaamo office&quot; src=&quot;static/img/vaamo-office.jpg&quot; /&gt;\n&lt;p style=&quot;font-size:0.4em&quot;&gt;Image &amp;copy; 2013 Vaamo Finanz AG. All rights reserved.&lt;/p&gt;&lt;/p&gt;&#39;, &#39;path&#39;: &#39;slides/01-who-we-are.md&#39;, &#39;title&#39;: &#39;who-we-are.md&#39;} -->
	    <section class="slide"  id="who-we-are.md" >
			
				
					<h2>Who we are</h2>
<p><img alt="Picture of the Vaamo office" src="static/img/vaamo-office.jpg" />
<p style="font-size:0.4em">Image &copy; 2013 Vaamo Finanz AG. All rights reserved.</p></p>
				
	  		
	    </section>
	
	    <!-- {&#39;markdown_content&#39;: u&#39;&lt;h2&gt;What we do&lt;/h2&gt;\n&lt;div class=&quot;container_12&quot;&gt;\n    &lt;div class=&quot;grid_4&quot;&gt;\n        &lt;/br&gt;&lt;/br&gt;      \n        &lt;img src=&quot;static/img/DDD.png&quot;/&gt;\n    &lt;/div&gt;\n    &lt;div class=&quot;grid_4&quot;&gt;\n        &lt;img src=&quot;static/img/softwerkskammer.png&quot;/&gt;\n    &lt;/div&gt;\n    &lt;div class=&quot;grid_4&quot;&gt;\n        &lt;img src=&quot;static/img/tdd.jpg&quot;/&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n\n&lt;div class=&quot;container_12&quot;&gt;\n    &lt;div class=&quot;grid_4&quot;&gt;\n        &lt;img src=&quot;static/img/scala.png&quot;/&gt;\n    &lt;/div&gt;\n    &lt;div class=&quot;grid_4&quot;&gt;\n        &lt;img src=&quot;static/img/playframework.png&quot;/&gt;\n    &lt;/div&gt;\n    &lt;div class=&quot;grid_4&quot;&gt;\n    &lt;/div&gt;\n&lt;/div&gt;&#39;, &#39;path&#39;: &#39;slides/02-what-we-do.md&#39;, &#39;title&#39;: &#39;what-we-do.md&#39;} -->
	    <section class="slide"  id="what-we-do.md" >
			
				
					<h2>What we do</h2>
<div class="container_12">
    <div class="grid_4">
        </br></br>      
        <img src="static/img/DDD.png"/>
    </div>
    <div class="grid_4">
        <img src="static/img/softwerkskammer.png"/>
    </div>
    <div class="grid_4">
        <img src="static/img/tdd.jpg"/>
    </div>
</div>

<div class="container_12">
    <div class="grid_4">
        <img src="static/img/scala.png"/>
    </div>
    <div class="grid_4">
        <img src="static/img/playframework.png"/>
    </div>
    <div class="grid_4">
    </div>
</div>
				
	  		
	    </section>
	
	    <!-- {&#39;markdown_content&#39;: u&quot;&lt;h2&gt;Structure&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;The Object-Relational mismatch&lt;/li&gt;\n&lt;li&gt;How does Event Sourcing work?&lt;/li&gt;\n&lt;li&gt;Considering Event Sourcing&lt;/li&gt;\n&lt;li&gt;Cool projects to watch&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3&gt;Unfortunately we won&#39;t be able to cover&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;How we do ES&lt;/li&gt;\n&lt;/ul&gt;&quot;, &#39;path&#39;: &#39;slides/03-structure.md&#39;, &#39;title&#39;: &#39;structure.md&#39;} -->
	    <section class="slide"  id="structure.md" >
			
				
					<h2>Structure</h2>
<ul>
<li>The Object-Relational mismatch</li>
<li>How does Event Sourcing work?</li>
<li>Considering Event Sourcing</li>
<li>Cool projects to watch</li>
</ul>
<h3>Unfortunately we won't be able to cover</h3>
<ul>
<li>How we do ES</li>
</ul>
				
	  		
	    </section>
	
	    <!-- {&#39;markdown_content&#39;: u&#39;&lt;h2&gt;Getting to know you&lt;/h2&gt;\n&lt;p&gt;Would you agree?&lt;/p&gt;\n&lt;ul&gt;\n&lt;li class=&quot;slide&quot;&gt;Our domain is mostly just CRUD operations&lt;/li&gt;\n&lt;li class=&quot;slide&quot;&gt;Our business objects map neatly to our DB Tables&lt;/li&gt;\n&lt;li class=&quot;slide&quot;&gt;We use Hibernate (or another ORM) for O-R Mapping&lt;/li&gt;\n&lt;li class=&quot;slide&quot;&gt;We have a sh*tload of services, mutating business objects&lt;/li&gt;\n&lt;li class=&quot;slide&quot;&gt;We do Domain-Driven Design&lt;/li&gt;\n&lt;/ul&gt;&#39;, &#39;path&#39;: &#39;slides/04-getting-to-know-you.md&#39;, &#39;title&#39;: &#39;getting-to-know-you.md&#39;} -->
	    <section class="slide"  id="getting-to-know-you.md" >
			
				
					<h2>Getting to know you</h2>
<p>Would you agree?</p>
<ul>
<li class="slide">Our domain is mostly just CRUD operations</li>
<li class="slide">Our business objects map neatly to our DB Tables</li>
<li class="slide">We use Hibernate (or another ORM) for O-R Mapping</li>
<li class="slide">We have a sh*tload of services, mutating business objects</li>
<li class="slide">We do Domain-Driven Design</li>
</ul>
				
	  		
	    </section>
	
	    <!-- {&#39;markdown_content&#39;: u&#39;&lt;h2&gt;Mapping O to R is suprisingly hard&lt;/h2&gt;\n&lt;div class=&quot;container_12&quot;&gt;\n    &lt;div class=&quot;grid_4&quot;&gt;\n        &lt;a href=&quot;http://martinfowler.com/books/eaa.html&quot;&gt;\n            &lt;img src=&quot;static/img/eaa.jpg&quot;&gt;\n        &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;div class=&quot;grid_8&quot;&gt;\n        &lt;ul&gt;\n            &lt;li&gt;143 pages on mapping O to R&lt;/li&gt;\n            &lt;li&gt;Recommends using ORM-Tools only for CRUD-heavy applications&lt;/li&gt;\n            &lt;li class=&quot;slide&quot;&gt;Why?&lt;/li&gt;\n        &lt;/ul&gt;\n    &lt;/div&gt;\n&lt;/div&gt;&#39;, &#39;path&#39;: &#39;slides/05-mismatch/01-mapping-O-to-R-is-hard.md&#39;, &#39;title&#39;: &#39;mismatch/01-mapping-O-to-R-is-hard.md&#39;} -->
	    <section class="slide"  id="mismatch/01-mapping-O-to-R-is-hard.md" >
			
				
					<h2>Mapping O to R is suprisingly hard</h2>
<div class="container_12">
    <div class="grid_4">
        <a href="http://martinfowler.com/books/eaa.html">
            <img src="static/img/eaa.jpg">
        </a>
    </div>
    <div class="grid_8">
        <ul>
            <li>143 pages on mapping O to R</li>
            <li>Recommends using ORM-Tools only for CRUD-heavy applications</li>
            <li class="slide">Why?</li>
        </ul>
    </div>
</div>
				
	  		
	    </section>
	
	    <!-- {&#39;markdown_content&#39;: u&#39;&lt;h2&gt;The Object-Relational mismatch&lt;/h2&gt;\n&lt;p&gt;&lt;a href=&quot;https://twitter.com/unclebobmartin/status/384682249301811200&quot;&gt;&lt;img alt=&quot;The biggest problem with ORM\&#39;s is that they don\&#39;t really map O to R. Tables _are not_ objects. They never were; and never will be.&quot; src=&quot;static/img/uncle-bob-tweet.png&quot; /&gt;&lt;/a&gt;&lt;/p&gt;&#39;, &#39;path&#39;: &#39;slides/05-mismatch/02-uncle-bob-citation.md&#39;, &#39;title&#39;: &#39;mismatch/02-uncle-bob-citation.md&#39;} -->
	    <section class="slide"  id="mismatch/02-uncle-bob-citation.md" >
			
				
					<h2>The Object-Relational mismatch</h2>
<p><a href="https://twitter.com/unclebobmartin/status/384682249301811200"><img alt="The biggest problem with ORM's is that they don't really map O to R. Tables _are not_ objects. They never were; and never will be." src="static/img/uncle-bob-tweet.png" /></a></p>
				
	  		
	    </section>
	
	    <!-- {&#39;markdown_content&#39;: u&#39;&lt;h1&gt;What is Event Sourcing?&lt;/h1&gt;&#39;, &#39;path&#39;: &#39;slides/06-how-eventsourcing-works/00-what-is-event-sourcing.md&#39;, &#39;title&#39;: &#39;how-eventsourcing-works/00-what-is-event-sourcing.md&#39;} -->
	    <section class="slide"  id="how-eventsourcing-works/00-what-is-event-sourcing.md" >
			
				
					<h1>What is Event Sourcing?</h1>
				
	  		
	    </section>
	
	    <!-- {&#39;markdown_content&#39;: u&#39;&lt;h2&gt;What is Event Sourcing?&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;An alternate way to save data &lt;/li&gt;\n&lt;li class=&quot;slide&quot;&gt;Mapping of objects to a stream of events, not to tables &lt;/li&gt;\n&lt;li class=&quot;slide&quot;&gt;Thus bypasses the Object-Relational Impedence Mismatch &lt;/li&gt;\n&lt;/ul&gt;&#39;, &#39;path&#39;: &#39;slides/06-how-eventsourcing-works/01-what-is-event-sourcing.md&#39;, &#39;title&#39;: &#39;how-eventsourcing-works/01-what-is-event-sourcing.md&#39;} -->
	    <section class="slide"  id="how-eventsourcing-works/01-what-is-event-sourcing.md" >
			
				
					<h2>What is Event Sourcing?</h2>
<ul>
<li>An alternate way to save data </li>
<li class="slide">Mapping of objects to a stream of events, not to tables </li>
<li class="slide">Thus bypasses the Object-Relational Impedence Mismatch </li>
</ul>
				
	  		
	    </section>
	
	    <!-- {&#39;markdown_content&#39;: u&#39;&lt;h2&gt;What is an Event?&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;Something that happend &lt;em&gt;in the past&lt;/em&gt;.&lt;/li&gt;\n&lt;li&gt;E.G. &lt;img alt=&quot;Deposit Performed Event in UML&quot; src=&quot;static/img/deposit-performed-event-v1.png&quot; /&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;!-- http://www.yuml.me/diagram/scruffy;/class/edit/[DepositPerformed|amount;accountNumber] --&gt;&#39;, &#39;path&#39;: &#39;slides/06-how-eventsourcing-works/02-what-is-an-event.md&#39;, &#39;title&#39;: &#39;how-eventsourcing-works/02-what-is-an-event.md&#39;} -->
	    <section class="slide"  id="how-eventsourcing-works/02-what-is-an-event.md" >
			
				
					<h2>What is an Event?</h2>
<ul>
<li>Something that happend <em>in the past</em>.</li>
<li>E.G. <img alt="Deposit Performed Event in UML" src="static/img/deposit-performed-event-v1.png" /></li>
</ul>
<!-- http://www.yuml.me/diagram/scruffy;/class/edit/[DepositPerformed|amount;accountNumber] -->
				
	  		
	    </section>
	
	    <!-- {&#39;markdown_content&#39;: u&#39;&lt;h2&gt;Saving Objects&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;Create an event for every state change of the object:&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p class=&quot;slide&quot;&gt;&lt;img alt=&quot;Eventstream&quot; src=&quot;static/img/eventstream.png&quot; /&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li class=&quot;slide&quot;&gt;Persist this stream of events, preserving their order&lt;/li&gt;\n&lt;/ul&gt;&#39;, &#39;path&#39;: &#39;slides/06-how-eventsourcing-works/03-saving-objects.md&#39;, &#39;title&#39;: &#39;how-eventsourcing-works/03-saving-objects.md&#39;} -->
	    <section class="slide"  id="how-eventsourcing-works/03-saving-objects.md" >
			
				
					<h2>Saving Objects</h2>
<ul>
<li>Create an event for every state change of the object:</li>
</ul>
<p class="slide"><img alt="Eventstream" src="static/img/eventstream.png" /></p>
<ul>
<li class="slide">Persist this stream of events, preserving their order</li>
</ul>
				
	  		
	    </section>
	
	    <!-- {&#39;markdown_content&#39;: u&#39;&lt;h2&gt;Restoring Objects&lt;/h2&gt;\n&lt;p&gt;Subsequently apply the events from the respective &lt;code&gt;EventStream&lt;/code&gt; to a fresh object instance&lt;/p&gt;\n&lt;p&gt;&lt;img alt=&quot;Eventstream&quot; src=&quot;static/img/eventstream.png&quot; /&gt;&lt;/p&gt;&#39;, &#39;path&#39;: &#39;slides/06-how-eventsourcing-works/04-restoring-objects-0.md&#39;, &#39;title&#39;: &#39;how-eventsourcing-works/04-restoring-objects-0.md&#39;} -->
	    <section class="slide"  id="how-eventsourcing-works/04-restoring-objects-0.md" >
			
				
					<h2>Restoring Objects</h2>
<p>Subsequently apply the events from the respective <code>EventStream</code> to a fresh object instance</p>
<p><img alt="Eventstream" src="static/img/eventstream.png" /></p>
				
	  		
	    </section>
	
	    <!-- {&#39;markdown_content&#39;: u&#39;&lt;h2&gt;Restoring Objects&lt;/h2&gt;\n&lt;p&gt;&lt;img alt=&quot;Restore from EventStream 1&quot; src=&quot;static/img/restore-from-eventstream-1.png&quot; /&gt;&lt;/p&gt;&#39;, &#39;path&#39;: &#39;slides/06-how-eventsourcing-works/04-restoring-objects-1.md&#39;, &#39;title&#39;: &#39;how-eventsourcing-works/04-restoring-objects-1.md&#39;} -->
	    <section class="slide"  id="how-eventsourcing-works/04-restoring-objects-1.md" >
			
				
					<h2>Restoring Objects</h2>
<p><img alt="Restore from EventStream 1" src="static/img/restore-from-eventstream-1.png" /></p>
				
	  		
	    </section>
	
	    <!-- {&#39;markdown_content&#39;: u&#39;&lt;h2&gt;Restoring Objects&lt;/h2&gt;\n&lt;p&gt;&lt;img alt=&quot;Restore from EventStream 2&quot; src=&quot;static/img/restore-from-eventstream-2.png&quot; /&gt;&lt;/p&gt;&#39;, &#39;path&#39;: &#39;slides/06-how-eventsourcing-works/04-restoring-objects-2.md&#39;, &#39;title&#39;: &#39;how-eventsourcing-works/04-restoring-objects-2.md&#39;} -->
	    <section class="slide"  id="how-eventsourcing-works/04-restoring-objects-2.md" >
			
				
					<h2>Restoring Objects</h2>
<p><img alt="Restore from EventStream 2" src="static/img/restore-from-eventstream-2.png" /></p>
				
	  		
	    </section>
	
	    <!-- {&#39;markdown_content&#39;: u&#39;&lt;h2&gt;Restoring Objects&lt;/h2&gt;\n&lt;p&gt;&lt;img alt=&quot;Restore from EventStream 3&quot; src=&quot;static/img/restore-from-eventstream-3.png&quot; /&gt;&lt;/p&gt;&#39;, &#39;path&#39;: &#39;slides/06-how-eventsourcing-works/04-restoring-objects-3.md&#39;, &#39;title&#39;: &#39;how-eventsourcing-works/04-restoring-objects-3.md&#39;} -->
	    <section class="slide"  id="how-eventsourcing-works/04-restoring-objects-3.md" >
			
				
					<h2>Restoring Objects</h2>
<p><img alt="Restore from EventStream 3" src="static/img/restore-from-eventstream-3.png" /></p>
				
	  		
	    </section>
	
	    <!-- {&#39;markdown_content&#39;: u&#39;&lt;h2&gt;Restoring Objects&lt;/h2&gt;\n&lt;p&gt;&lt;img alt=&quot;Restore from EventStream 4&quot; src=&quot;static/img/restore-from-eventstream-4.png&quot; /&gt;&lt;/p&gt;&#39;, &#39;path&#39;: &#39;slides/06-how-eventsourcing-works/04-restoring-objects-4.md&#39;, &#39;title&#39;: &#39;how-eventsourcing-works/04-restoring-objects-4.md&#39;} -->
	    <section class="slide"  id="how-eventsourcing-works/04-restoring-objects-4.md" >
			
				
					<h2>Restoring Objects</h2>
<p><img alt="Restore from EventStream 4" src="static/img/restore-from-eventstream-4.png" /></p>
				
	  		
	    </section>
	
	    <!-- {&#39;markdown_content&#39;: u&#39;&lt;p&gt;&lt;img alt=&quot;Restore from EventStream 2&quot; src=&quot;static/img/restore-from-eventstream.png&quot; /&gt;&lt;/p&gt;&#39;, &#39;path&#39;: &#39;slides/06-how-eventsourcing-works/04-restoring-objects-5.md&#39;, &#39;title&#39;: &#39;how-eventsourcing-works/04-restoring-objects-5.md&#39;} -->
	    <section class="slide"  id="how-eventsourcing-works/04-restoring-objects-5.md" >
			
				
					<p><img alt="Restore from EventStream 2" src="static/img/restore-from-eventstream.png" /></p>
				
	  		
	    </section>
	
	    <!-- {&#39;markdown_content&#39;: u&#39;&lt;h2&gt;Updating Objects&lt;/h2&gt;\n&lt;div class=&quot;codehilite&quot;&gt;&lt;pre&gt;&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;account&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;accountRepository&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;\n&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;modifiedAccount&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;account&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withdraw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Euro&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;\n&lt;span class=&quot;n&quot;&gt;accountRepository&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;modifiedAccount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;\n&lt;/pre&gt;&lt;/div&gt;\n\n\n&lt;p&gt;What should be persisted?&lt;/p&gt;\n&lt;p class=&quot;slide&quot;&gt;&lt;img alt=&quot;Updating EventStream&quot; src=&quot;static/img/eventstream-update.png&quot; /&gt;&lt;/p&gt;&#39;, &#39;path&#39;: &#39;slides/06-how-eventsourcing-works/05-updating objects.md&#39;, &#39;title&#39;: &#39;how-eventsourcing-works/05-updating objects.md&#39;} -->
	    <section class="slide"  id="how-eventsourcing-works/05-updating objects.md" >
			
				
					<h2>Updating Objects</h2>
<div class="codehilite"><pre><span class="k">val</span> <span class="n">account</span> <span class="k">=</span> <span class="n">accountRepository</span><span class="o">.</span><span class="n">get</span><span class="o">(</span><span class="mi">123</span><span class="o">)</span>
<span class="k">val</span> <span class="n">modifiedAccount</span> <span class="k">=</span> <span class="n">account</span><span class="o">.</span><span class="n">withdraw</span><span class="o">(</span><span class="k">new</span> <span class="nc">Euro</span><span class="o">(</span><span class="mi">10</span><span class="o">))</span>
<span class="n">accountRepository</span><span class="o">.</span><span class="n">save</span><span class="o">(</span><span class="n">modifiedAccount</span><span class="o">)</span>
</pre></div>


<p>What should be persisted?</p>
<p class="slide"><img alt="Updating EventStream" src="static/img/eventstream-update.png" /></p>
				
	  		
	    </section>
	
	    <!-- {&#39;markdown_content&#39;: u&#39;&lt;h2&gt;Deleting Objects&lt;/h2&gt;\n&lt;p&gt;How do you delete an object?&lt;/p&gt;\n&lt;p  class=&quot;slide&quot;&gt;\n&lt;img src=&quot;static/img/bank-account-closed-event.png&quot; style=&quot;margin:0px&quot;/&gt;\n&lt;/p&gt;\n\n&lt;p class=&quot;slide&quot;&gt;&lt;a href=&quot;http://martinfowler.com/eaaDev/RetroactiveEvent.html&quot;&gt;Retroactive Event&lt;/a&gt;. An event undoing something that happened in the past&lt;/p&gt;&#39;, &#39;path&#39;: &#39;slides/06-how-eventsourcing-works/06-deleting-objects.md&#39;, &#39;title&#39;: &#39;how-eventsourcing-works/06-deleting-objects.md&#39;} -->
	    <section class="slide"  id="how-eventsourcing-works/06-deleting-objects.md" >
			
				
					<h2>Deleting Objects</h2>
<p>How do you delete an object?</p>
<p  class="slide">
<img src="static/img/bank-account-closed-event.png" style="margin:0px"/>
</p>

<p class="slide"><a href="http://martinfowler.com/eaaDev/RetroactiveEvent.html">Retroactive Event</a>. An event undoing something that happened in the past</p>
				
	  		
	    </section>
	
	    <!-- {&#39;markdown_content&#39;: u&#39;&lt;h2&gt;Event Sourcing vs Command Sourcing&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;Command Sourcing and Event Sourcing are very similar&lt;/li&gt;\n&lt;li class=&quot;slide&quot;&gt;Terms tend to get confused on the web&lt;/li&gt;\n&lt;li class=&quot;slide&quot;&gt;&lt;a href=&quot;http://www.martinfowler.com/eaaDev/EventSourcing.html&quot;&gt;Martin Fowler&lt;/a&gt; wrote about what we call Command Sourcing&lt;/li&gt;\n&lt;/ul&gt;&#39;, &#39;path&#39;: &#39;slides/06-how-eventsourcing-works/07-event-sourcing-vs-command-sourcing.md&#39;, &#39;title&#39;: &#39;how-eventsourcing-works/07-event-sourcing-vs-command-sourcing.md&#39;} -->
	    <section class="slide"  id="how-eventsourcing-works/07-event-sourcing-vs-command-sourcing.md" >
			
				
					<h2>Event Sourcing vs Command Sourcing</h2>
<ul>
<li>Command Sourcing and Event Sourcing are very similar</li>
<li class="slide">Terms tend to get confused on the web</li>
<li class="slide"><a href="http://www.martinfowler.com/eaaDev/EventSourcing.html">Martin Fowler</a> wrote about what we call Command Sourcing</li>
</ul>
				
	  		
	    </section>
	
	    <!-- {&#39;markdown_content&#39;: u&#39;&lt;h2&gt;Command Sourcing&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;Command Pattern as defined in &quot;Design Patterns&quot;&lt;/li&gt;\n&lt;li&gt;Command names are imperative &quot;do something!&quot;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;div class=&quot;codehilite&quot;&gt;&lt;pre&gt;&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ChangeOwner&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;accountID&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;UUID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;newOwner&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Command&lt;/span&gt;\n\n\n\n&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;BankAccountCommandHandler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bankAccountRepo&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;BankAccountRepository&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;\n\n  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;handle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;changeOwner&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;ChangeOwner&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;\n\n    &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;account&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bankAccountRepo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getAccount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;changeOwner&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;accountID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;\n\n    &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;modifiedAccount&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;account&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;changeOwner&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;changeOwner&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;newOwner&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;\n\n    &lt;span class=&quot;n&quot;&gt;bankAccountRepo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;saveAccount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;modifiedAccount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;\n\n  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;\n\n&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;\n&lt;/pre&gt;&lt;/div&gt;&#39;, &#39;path&#39;: &#39;slides/06-how-eventsourcing-works/08-command-sourcing.md&#39;, &#39;title&#39;: &#39;how-eventsourcing-works/08-command-sourcing.md&#39;} -->
	    <section class="slide"  id="how-eventsourcing-works/08-command-sourcing.md" >
			
				
					<h2>Command Sourcing</h2>
<ul>
<li>Command Pattern as defined in "Design Patterns"</li>
<li>Command names are imperative "do something!"</li>
</ul>
<div class="codehilite"><pre><span class="k">case</span> <span class="k">class</span> <span class="nc">ChangeOwner</span><span class="o">(</span><span class="n">accountID</span><span class="k">:</span> <span class="kt">UUID</span><span class="o">,</span> <span class="n">newOwner</span><span class="k">:</span><span class="kt">String</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Command</span>



<span class="k">class</span> <span class="nc">BankAccountCommandHandler</span><span class="o">(</span><span class="n">bankAccountRepo</span><span class="k">:</span><span class="kt">BankAccountRepository</span><span class="o">)</span> <span class="o">{</span>

  <span class="k">def</span> <span class="n">handle</span><span class="o">(</span><span class="n">changeOwner</span><span class="k">:</span><span class="kt">ChangeOwner</span><span class="o">)</span> <span class="o">{</span>

    <span class="k">val</span> <span class="n">account</span> <span class="k">=</span> <span class="n">bankAccountRepo</span><span class="o">.</span><span class="n">getAccount</span><span class="o">(</span><span class="n">changeOwner</span><span class="o">.</span><span class="n">accountID</span><span class="o">)</span>

    <span class="k">val</span> <span class="n">modifiedAccount</span> <span class="k">=</span> <span class="n">account</span><span class="o">.</span><span class="n">changeOwner</span><span class="o">(</span><span class="n">changeOwner</span><span class="o">.</span><span class="n">newOwner</span><span class="o">)</span>

    <span class="n">bankAccountRepo</span><span class="o">.</span><span class="n">saveAccount</span><span class="o">(</span><span class="n">modifiedAccount</span><span class="o">)</span>

  <span class="o">}</span>

<span class="o">}</span>
</pre></div>
				
	  		
	    </section>
	
	    <!-- {&#39;markdown_content&#39;: u&#39;&lt;h2&gt;Command Sourcing&lt;/h2&gt;\n&lt;h3 class=&quot;pros&quot;&gt;Pros&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;A bit easier to implement&lt;/li&gt;\n&lt;li&gt;Command log doubles as full audit log&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 class=&quot;cons&quot;&gt;Cons&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;Replaying may inflict unexpected side effects&lt;/li&gt;\n&lt;/ul&gt;&#39;, &#39;path&#39;: &#39;slides/06-how-eventsourcing-works/09-command-sourcing-advantages.md&#39;, &#39;title&#39;: &#39;how-eventsourcing-works/09-command-sourcing-advantages.md&#39;} -->
	    <section class="slide"  id="how-eventsourcing-works/09-command-sourcing-advantages.md" >
			
				
					<h2>Command Sourcing</h2>
<h3 class="pros">Pros</h3>
<ul>
<li>A bit easier to implement</li>
<li>Command log doubles as full audit log</li>
</ul>
<h3 class="cons">Cons</h3>
<ul>
<li>Replaying may inflict unexpected side effects</li>
</ul>
				
	  		
	    </section>
	
	    <!-- {&#39;markdown_content&#39;: u&#39;&lt;h2&gt;Dealing with side effects&lt;/h2&gt;\n&lt;p&gt;How do we deal with side effects?&lt;/p&gt;\n&lt;ul&gt;\n&lt;li class=&quot;slide&quot;&gt;Leave side effect to the command handler &lt;/li&gt;\n&lt;li class=&quot;slide&quot;&gt;Record result as domain event, if necessary &lt;/li&gt;\n&lt;/ul&gt;&#39;, &#39;path&#39;: &#39;slides/06-how-eventsourcing-works/10-side-effects.md&#39;, &#39;title&#39;: &#39;how-eventsourcing-works/10-side-effects.md&#39;} -->
	    <section class="slide"  id="how-eventsourcing-works/10-side-effects.md" >
			
				
					<h2>Dealing with side effects</h2>
<p>How do we deal with side effects?</p>
<ul>
<li class="slide">Leave side effect to the command handler </li>
<li class="slide">Record result as domain event, if necessary </li>
</ul>
				
	  		
	    </section>
	
	    <!-- {&#39;markdown_content&#39;: u&#39;&lt;div class=&quot;codehilite&quot;&gt;&lt;pre&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;BrokerCommandHandler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bankInterface&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;BankInterface&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;\n\n                            &lt;span class=&quot;n&quot;&gt;orderBookRepository&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;OrderBookRepository&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;\n\n  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;handle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buyCommand&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;PerformBuyOrder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;\n\n    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orderBook&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orderBookRepository&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buyCommand&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orderBookId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;\n\n    &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;validationResult&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bankInterface&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;validate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buyCommand&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;order&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;\n\n    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;validationResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;succeeded&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;\n\n      &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;InvalidOrderException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;validationResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;\n\n    &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orderConfirmation&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bankInterface&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;perform&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buyCommand&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;order&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;\n\n    &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orderPerformedEvent&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;OrderSentToBank&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orderConfirmation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;\n\n    &lt;span class=&quot;n&quot;&gt;orderBook&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orderBook&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;handle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orderPerformedEvent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;\n\n    &lt;span class=&quot;n&quot;&gt;orderBookRepository&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orderBook&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;\n\n  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;\n\n&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;\n\n\n\n&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;OrderBook&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Seq&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Order&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Seq&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;empty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;\n\n  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;handle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orderSentToBank&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;OrderSentToBank&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;OrderBook&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;\n\n    &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;copy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orderSentToBank&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;order&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;\n\n  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;\n\n&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;\n&lt;/pre&gt;&lt;/div&gt;&#39;, &#39;path&#39;: &#39;slides/06-how-eventsourcing-works/11-side-effects-example.md&#39;, &#39;title&#39;: &#39;how-eventsourcing-works/11-side-effects-example.md&#39;} -->
	    <section class="slide"  id="how-eventsourcing-works/11-side-effects-example.md" >
			
				
					<div class="codehilite"><pre><span class="k">class</span> <span class="nc">BrokerCommandHandler</span> <span class="o">(</span><span class="n">bankInterface</span><span class="k">:</span><span class="kt">BankInterface</span><span class="o">,</span>

                            <span class="n">orderBookRepository</span><span class="k">:</span><span class="kt">OrderBookRepository</span><span class="o">)</span> <span class="o">{</span>

  <span class="k">def</span> <span class="n">handle</span><span class="o">(</span><span class="n">buyCommand</span><span class="k">:</span><span class="kt">PerformBuyOrder</span><span class="o">)</span> <span class="k">=</span> <span class="o">{</span>

    <span class="k">var</span> <span class="n">orderBook</span> <span class="k">=</span> <span class="n">orderBookRepository</span><span class="o">.</span><span class="n">load</span><span class="o">(</span><span class="n">buyCommand</span><span class="o">.</span><span class="n">orderBookId</span><span class="o">)</span>

    <span class="k">val</span> <span class="n">validationResult</span> <span class="k">=</span> <span class="n">bankInterface</span><span class="o">.</span><span class="n">validate</span><span class="o">(</span><span class="n">buyCommand</span><span class="o">.</span><span class="n">order</span><span class="o">)</span>

    <span class="k">if</span> <span class="o">(!</span><span class="n">validationResult</span><span class="o">.</span><span class="n">succeeded</span><span class="o">)</span>

      <span class="k">throw</span> <span class="k">new</span> <span class="nc">InvalidOrderException</span><span class="o">(</span><span class="n">validationResult</span><span class="o">)</span>

    <span class="k">val</span> <span class="n">orderConfirmation</span> <span class="k">=</span> <span class="n">bankInterface</span><span class="o">.</span><span class="n">perform</span><span class="o">(</span><span class="n">buyCommand</span><span class="o">.</span><span class="n">order</span><span class="o">)</span>

    <span class="k">val</span> <span class="n">orderPerformedEvent</span> <span class="k">=</span> <span class="nc">OrderSentToBank</span><span class="o">.</span><span class="n">from</span><span class="o">(</span><span class="n">orderConfirmation</span><span class="o">)</span>

    <span class="n">orderBook</span> <span class="k">=</span> <span class="n">orderBook</span><span class="o">.</span><span class="n">handle</span><span class="o">(</span><span class="n">orderPerformedEvent</span><span class="o">)</span>

    <span class="n">orderBookRepository</span><span class="o">.</span><span class="n">save</span><span class="o">(</span><span class="n">orderBook</span><span class="o">)</span>

  <span class="o">}</span>

<span class="o">}</span>



<span class="k">case</span> <span class="k">class</span> <span class="nc">OrderBook</span><span class="o">(</span><span class="n">orders</span><span class="k">:</span><span class="kt">Seq</span><span class="o">[</span><span class="kt">Order</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">.</span><span class="n">empty</span><span class="o">)</span> <span class="o">{</span>

  <span class="k">def</span> <span class="n">handle</span><span class="o">(</span><span class="n">orderSentToBank</span><span class="k">:</span><span class="kt">OrderSentToBank</span><span class="o">)</span> <span class="k">:</span> <span class="kt">OrderBook</span> <span class="o">=</span> <span class="o">{</span>

    <span class="k">this</span><span class="o">.</span><span class="n">copy</span><span class="o">(</span><span class="n">orders</span> <span class="o">:+</span> <span class="n">orderSentToBank</span><span class="o">.</span><span class="n">order</span><span class="o">)</span>

  <span class="o">}</span>

<span class="o">}</span>
</pre></div>
				
	  		
	    </section>
	
	    <!-- {&#39;markdown_content&#39;: u&#39;&lt;h1&gt;Considering Event Sourcing&lt;/h1&gt;&#39;, &#39;path&#39;: &#39;slides/07-should-i-do-event-sourcing/00-considering-event-sourcing.md&#39;, &#39;title&#39;: &#39;should-i-do-event-sourcing/00-considering-event-sourcing.md&#39;} -->
	    <section class="slide"  id="should-i-do-event-sourcing/00-considering-event-sourcing.md" >
			
				
					<h1>Considering Event Sourcing</h1>
				
	  		
	    </section>
	
	    <!-- {&#39;markdown_content&#39;: u&#39;&lt;h2&gt;Pros and Cons of Event/Command Sourcing&lt;/h2&gt;\n&lt;h3&gt;Pros&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;Bypass the O-R Impedance Mismatch&lt;/li&gt;\n&lt;li&gt;Allows for easy undo mechanism&lt;/li&gt;\n&lt;li&gt;Debuggability and accountability&lt;/li&gt;\n&lt;li&gt;After-the-fact mining of Event Streams&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3&gt;Cons&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;Awkward to query Domain Model (solved by CQRS)&lt;/li&gt;\n&lt;li&gt;Takes a bit of getting used to&lt;/li&gt;\n&lt;li&gt;Much less framework/community/vendor support&lt;/li&gt;\n&lt;/ul&gt;&#39;, &#39;path&#39;: &#39;slides/07-should-i-do-event-sourcing/01-pros-and-cons-of-event-sourcing.md&#39;, &#39;title&#39;: &#39;should-i-do-event-sourcing/01-pros-and-cons-of-event-sourcing.md&#39;} -->
	    <section class="slide"  id="should-i-do-event-sourcing/01-pros-and-cons-of-event-sourcing.md" >
			
				
					<h2>Pros and Cons of Event/Command Sourcing</h2>
<h3>Pros</h3>
<ul>
<li>Bypass the O-R Impedance Mismatch</li>
<li>Allows for easy undo mechanism</li>
<li>Debuggability and accountability</li>
<li>After-the-fact mining of Event Streams</li>
</ul>
<h3>Cons</h3>
<ul>
<li>Awkward to query Domain Model (solved by CQRS)</li>
<li>Takes a bit of getting used to</li>
<li>Much less framework/community/vendor support</li>
</ul>
				
	  		
	    </section>
	
	    <!-- {&#39;markdown_content&#39;: u&#39;&lt;h2&gt;Debugging and accountability&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;Every change to state is traceable&lt;/li&gt;\n&lt;li&gt;You know how the system got into the current state&lt;/li&gt;\n&lt;li&gt;Metadata like &quot;who did that&quot; and &quot;when did it happen&quot; &lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;img alt=&quot;Eventstream&quot; src=&quot;static/img/eventstream.png&quot; /&gt;&lt;/p&gt;&#39;, &#39;path&#39;: &#39;slides/07-should-i-do-event-sourcing/02-debugging-and-accountability.md&#39;, &#39;title&#39;: &#39;should-i-do-event-sourcing/02-debugging-and-accountability.md&#39;} -->
	    <section class="slide"  id="should-i-do-event-sourcing/02-debugging-and-accountability.md" >
			
				
					<h2>Debugging and accountability</h2>
<ul>
<li>Every change to state is traceable</li>
<li>You know how the system got into the current state</li>
<li>Metadata like "who did that" and "when did it happen" </li>
</ul>
<p><img alt="Eventstream" src="static/img/eventstream.png" /></p>
				
	  		
	    </section>
	
	    <!-- {&#39;markdown_content&#39;: u&#39;&lt;h2&gt;Retrospective mining of Event Streams&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;Collection of previously uncollected metrics and infos is possible&lt;/li&gt;\n&lt;li&gt;E.G. A recommendation engine that recommends customers items, they removed from their shopping cart&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;img alt=&quot;Eventstream&quot; src=&quot;static/img/eventstream.png&quot; /&gt;&lt;/p&gt;&#39;, &#39;path&#39;: &#39;slides/07-should-i-do-event-sourcing/03-mining-event-streams.md&#39;, &#39;title&#39;: &#39;should-i-do-event-sourcing/03-mining-event-streams.md&#39;} -->
	    <section class="slide"  id="should-i-do-event-sourcing/03-mining-event-streams.md" >
			
				
					<h2>Retrospective mining of Event Streams</h2>
<ul>
<li>Collection of previously uncollected metrics and infos is possible</li>
<li>E.G. A recommendation engine that recommends customers items, they removed from their shopping cart</li>
</ul>
<p><img alt="Eventstream" src="static/img/eventstream.png" /></p>
				
	  		
	    </section>
	
	    <!-- {&#39;markdown_content&#39;: u&#39;&lt;h2&gt;Should I be doing Event Sourcing?&lt;/h2&gt;\n&lt;p&gt;Event Sourcing is probably a good fit when you are:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;experienced in Domain-Driven Design &lt;/li&gt;\n&lt;li&gt;building a system doing more than simple CRUD&lt;/li&gt;\n&lt;li&gt;the accountability/debuggability is critical&lt;/li&gt;\n&lt;li&gt;deriving a competitive edge from the data&lt;/li&gt;\n&lt;li&gt;building a scaleable system based on CQRS princples&lt;/li&gt;\n&lt;/ul&gt;&#39;, &#39;path&#39;: &#39;slides/07-should-i-do-event-sourcing/04-should-i-be-doing-event-sourcing.md&#39;, &#39;title&#39;: &#39;should-i-do-event-sourcing/04-should-i-be-doing-event-sourcing.md&#39;} -->
	    <section class="slide"  id="should-i-do-event-sourcing/04-should-i-be-doing-event-sourcing.md" >
			
				
					<h2>Should I be doing Event Sourcing?</h2>
<p>Event Sourcing is probably a good fit when you are:</p>
<ul>
<li>experienced in Domain-Driven Design </li>
<li>building a system doing more than simple CRUD</li>
<li>the accountability/debuggability is critical</li>
<li>deriving a competitive edge from the data</li>
<li>building a scaleable system based on CQRS princples</li>
</ul>
				
	  		
	    </section>
	
	    <!-- {&#39;markdown_content&#39;: u&#39;&lt;h1&gt;Interesting Projects&lt;/h1&gt;&#39;, &#39;path&#39;: &#39;slides/09-interesting-projects/00-interesting-projects.md&#39;, &#39;title&#39;: &#39;interesting-projects/00-interesting-projects.md&#39;} -->
	    <section class="slide"  id="interesting-projects/00-interesting-projects.md" >
			
				
					<h1>Interesting Projects</h1>
				
	  		
	    </section>
	
	    <!-- {&#39;markdown_content&#39;: u&#39;&lt;h2&gt;Event Store&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;Open Source Database for Event Sourcing&lt;/li&gt;\n&lt;li&gt;Project driven by Greg Young&lt;/li&gt;\n&lt;li&gt;Works on Mono/.Net&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;https://github.com/EventStore/eventstorejvmclient&quot;&gt;Early version of Java/Scala Bindings&lt;/a&gt; available&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;http://geteventstore.com/&quot;&gt;More Information available here&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;img src=&quot;static/img/ouro.png&quot; style=&quot;float:right;width:30%&quot;/&gt;&lt;/p&gt;&#39;, &#39;path&#39;: &#39;slides/09-interesting-projects/01-event-store.md&#39;, &#39;title&#39;: &#39;interesting-projects/01-event-store.md&#39;} -->
	    <section class="slide"  id="interesting-projects/01-event-store.md" >
			
				
					<h2>Event Store</h2>
<ul>
<li>Open Source Database for Event Sourcing</li>
<li>Project driven by Greg Young</li>
<li>Works on Mono/.Net</li>
<li><a href="https://github.com/EventStore/eventstorejvmclient">Early version of Java/Scala Bindings</a> available</li>
<li><a href="http://geteventstore.com/">More Information available here</a></li>
</ul>
<p><img src="static/img/ouro.png" style="float:right;width:30%"/></p>
				
	  		
	    </section>
	
	    <!-- {&#39;markdown_content&#39;: u&#39;&lt;h2&gt;Akka Persistence&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;Experimental extension for Akka&lt;/li&gt;\n&lt;li&gt;Based on the Actor model&lt;/li&gt;\n&lt;li&gt;Supports both Command and Event Sourcing&lt;/li&gt;\n&lt;li&gt;Works with Java or Scala&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;http://doc.akka.io/docs/akka/snapshot/java/persistence.html&quot;&gt;More Information available here&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;img src=&quot;static/img/akka.png&quot; style=&quot;float:right;width:40%&quot;/&gt;&lt;/p&gt;&#39;, &#39;path&#39;: &#39;slides/09-interesting-projects/02-akka-persistence.md&#39;, &#39;title&#39;: &#39;interesting-projects/02-akka-persistence.md&#39;} -->
	    <section class="slide"  id="interesting-projects/02-akka-persistence.md" >
			
				
					<h2>Akka Persistence</h2>
<ul>
<li>Experimental extension for Akka</li>
<li>Based on the Actor model</li>
<li>Supports both Command and Event Sourcing</li>
<li>Works with Java or Scala</li>
<li><a href="http://doc.akka.io/docs/akka/snapshot/java/persistence.html">More Information available here</a></li>
</ul>
<p><img src="static/img/akka.png" style="float:right;width:40%"/></p>
				
	  		
	    </section>
	
	    <!-- {&#39;markdown_content&#39;: u&#39;&lt;h1&gt;Thank you for your kind attention&lt;/h1&gt;&#39;, &#39;path&#39;: &#39;slides/98-thanks.md&#39;, &#39;title&#39;: &#39;thanks.md&#39;} -->
	    <section class="slide"  id="thanks.md" >
			
				
					<h1>Thank you for your kind attention</h1>
				
	  		
	    </section>
	
	    <!-- {&#39;markdown_content&#39;: u&#39;&lt;h2&gt;Sources and further reading&lt;/h2&gt;\n&lt;h3&gt;Event Sourcing theory&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=&quot;http://www.martinfowler.com/eaaDev/EventSourcing.html&quot;&gt;Martin Fowler on Event Sourcing&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;http://www.martinfowler.com/eaaDev/DomainEvent.html&quot;&gt;Martin Fowler on Domain Events&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;Note: What Martin Fowler calls Domain Events, we came to recognise as Commands. The article &lt;a href=&quot;http://thinkbeforecoding.com/post/2013/07/28/Event-Sourcing-vs-Command-Sourcing&quot;&gt;Event Sourcing vs Command Sourcing&lt;/a&gt; explains the difference.&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;https://vaughnvernon.co/?page_id=168&quot;&gt;Implementing Domain-Driven Design by Vaughn Vernom&lt;/a&gt; covers Event Sourcing in Appendix A&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3&gt;Event sourcing implementation&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=&quot;http://abdullin.com/storage/uploads/2010/04/2010-04-16_DDDD_Drafts_by_Greg_Young.pdf&quot;&gt;DDDD by Greg Young&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;http://bliki.abdullin.com/event-sourcing/versioning&quot;&gt;Event versioning and evolutions&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;&#39;, &#39;path&#39;: &#39;slides/99-further-reading-1.md&#39;, &#39;title&#39;: &#39;further-reading-1.md&#39;} -->
	    <section class="slide"  id="further-reading-1.md" >
			
				
					<h2>Sources and further reading</h2>
<h3>Event Sourcing theory</h3>
<ul>
<li><a href="http://www.martinfowler.com/eaaDev/EventSourcing.html">Martin Fowler on Event Sourcing</a></li>
<li><a href="http://www.martinfowler.com/eaaDev/DomainEvent.html">Martin Fowler on Domain Events</a></li>
<li>Note: What Martin Fowler calls Domain Events, we came to recognise as Commands. The article <a href="http://thinkbeforecoding.com/post/2013/07/28/Event-Sourcing-vs-Command-Sourcing">Event Sourcing vs Command Sourcing</a> explains the difference.</li>
<li><a href="https://vaughnvernon.co/?page_id=168">Implementing Domain-Driven Design by Vaughn Vernom</a> covers Event Sourcing in Appendix A</li>
</ul>
<h3>Event sourcing implementation</h3>
<ul>
<li><a href="http://abdullin.com/storage/uploads/2010/04/2010-04-16_DDDD_Drafts_by_Greg_Young.pdf">DDDD by Greg Young</a></li>
<li><a href="http://bliki.abdullin.com/event-sourcing/versioning">Event versioning and evolutions</a></li>
</ul>
				
	  		
	    </section>
	
	    <!-- {&#39;markdown_content&#39;: u&#39;&lt;h2&gt;Sources and further reading&lt;/h2&gt;\n&lt;h3&gt;Command-Query Responsibility Segregation (CQRS)&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=&quot;http://skillsmatter.com/expert-profile/design-architecture/greg-young&quot;&gt;Greg Young on the Business Side of CQRS/ES&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;http://msdn.microsoft.com/en-us/library/jj554200.aspx&quot;&gt;A CQRS Journey by Microsoft&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3&gt;Example Projects&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=&quot;https://github.com/gregoryyoung/m-r&quot;&gt;Simple CQRS + Event Sourcing example&lt;/a&gt; Technology: Plain C# &lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;https://github.com/mspnp/cqrs-journey-code&quot;&gt;Microsoft\&#39;s CQRS Journey code&lt;/a&gt; Technology: C#/Azure&lt;/li&gt;\n&lt;/ul&gt;&#39;, &#39;path&#39;: &#39;slides/99-further-reading-2.md&#39;, &#39;title&#39;: &#39;further-reading-2.md&#39;} -->
	    <section class="slide"  id="further-reading-2.md" >
			
				
					<h2>Sources and further reading</h2>
<h3>Command-Query Responsibility Segregation (CQRS)</h3>
<ul>
<li><a href="http://skillsmatter.com/expert-profile/design-architecture/greg-young">Greg Young on the Business Side of CQRS/ES</a></li>
<li><a href="http://msdn.microsoft.com/en-us/library/jj554200.aspx">A CQRS Journey by Microsoft</a></li>
</ul>
<h3>Example Projects</h3>
<ul>
<li><a href="https://github.com/gregoryyoung/m-r">Simple CQRS + Event Sourcing example</a> Technology: Plain C# </li>
<li><a href="https://github.com/mspnp/cqrs-journey-code">Microsoft's CQRS Journey code</a> Technology: C#/Azure</li>
</ul>
				
	  		
	    </section>
	


    <!-- End slides. -->

  <!-- Begin extension snippets. Add or remove as needed. -->

    <!-- deck.navigation snippet -->
    <a href="#" class="deck-prev-link" title="Previous">&#8592;</a>
    <a href="#" class="deck-next-link" title="Next">&#8594;</a>

    <!-- deck.status snippet -->
    <p class="deck-status">
      <span class="deck-status-current"></span>
      /
      <span class="deck-status-total"></span>
    </p>

    <!-- deck.goto snippet -->
    <form action="." method="get" class="goto-form">
      <label for="goto-slide">Go to slide:</label>
      <input type="text" name="slidenum" id="goto-slide" list="goto-datalist">
      <datalist id="goto-datalist"></datalist>
      <input type="submit" value="Go">
    </form>

    <!-- deck.hash snippet -->
    <a href="." title="Permalink to this slide" class="deck-permalink">#</a>

    <!-- End extension snippets. -->
  </div>

<!-- Required JS files. -->
<script src="./static/jquery.min.js"></script>
<script src="./static/core/deck.core.js"></script>

<!-- Extension JS files. Add or remove as needed. -->
<script src="./static/core/deck.core.js"></script>
<script src="./static/extensions/hash/deck.hash.js"></script>
<script src="./static/extensions/menu/deck.menu.js"></script>
<script src="./static/extensions/goto/deck.goto.js"></script>
<script src="./static/extensions/status/deck.status.js"></script>
<script src="./static/extensions/navigation/deck.navigation.js"></script>
<script src="./static/extensions/scale/deck.scale.js"></script>

<!-- Initialize the deck. You can put this in an external file if desired. -->
<script>
  $(function() {
    $.deck('.slide');
  });
</script>
</body>
</html>

