How to resolve race conditions that occur due to concurrent writes?